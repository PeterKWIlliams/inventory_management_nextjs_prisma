// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model User {
  id         Int          @id @default(autoincrement())
  email      String       @unique
  name       String?
  address    address      @relation(fields: [addressId], references: [id])
  addressId  Int
  management management[]

  @@index([addressId])
}

model household {
  id         Int          @id @default(autoincrement())
  name       String
  address    address      @relation(fields: [addressId], references: [id])
  addressId  Int
  management management[]

  @@index([addressId])
}

model address {
  id        Int         @id @default(autoincrement())
  street    String
  city      String
  postcode  String
  household household[]
  User      User[]
}

model management {
  id           Int         @id @default(autoincrement())
  user         User        @relation(fields: [userId], references: [id])
  house_hold   household   @relation(fields: [house_holdId], references: [id])
  userId       Int
  house_holdId Int
  inventory    inventory[]

  @@index([house_holdId])
  @@index([userId])
}

model inventory {
  id                 Int              @id @default(autoincrement())
  management         management       @relation(fields: [managementId], references: [id])
  managementId       Int
  storage_location   storage_location @relation(fields: [storage_locationId], references: [id])
  storage_locationId Int

  @@index([storage_locationId])
  @@index([managementId])
}

model storage_location {
  id       Int    @id @default(autoincrement())
  name     String
  Location String

  stored_items stored_items[]

  inventory inventory[]
}

model stored_items {
  id                 Int              @id @default(autoincrement())
  name               String
  expiry_date        DateTime
  purchase_date      DateTime
  purchase_link      String
  image_url          String
  desired_quantity   Int
  quantity           Int
  storage_location   storage_location @relation(fields: [storage_locationId], references: [id])
  storage_locationId Int

  @@index([storage_locationId])
}

model distributor {
  id                Int                 @id @default(autoincrement())
  name              String
  address           String
  purchasable_items purchasable_items[]
}

model purchasable_items {
  id            Int         @id @default(autoincrement())
  distributor   distributor @relation(fields: [distributorId], references: [id])
  distributorId Int
  item          item        @relation(fields: [itemId], references: [id])
  itemId        Int

  @@index([itemId])
  @@index([distributorId])
}

model item {
  id                Int                 @id @default(autoincrement())
  name              String
  purchase_link     String
  image_url         String
  price             Float
  purchasable_items purchasable_items[]
}
