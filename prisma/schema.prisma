// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model User {
  id                  Int                   @id @default(autoincrement())
  email               String                @unique
  first_name          String
  last_name           String
  user_address        Address               @relation("UserAddress", fields: [addressId], references: [id])
  addressId           Int
  inventoryManagement InventoryManagement[]
  clerkId             String                @unique

  @@index([addressId])
}

model Household {
  id                  Int                   @id @default(autoincrement())
  name                String
  household_address   Address               @relation("HouseholdAddress", fields: [addressId], references: [id])
  addressId           Int
  inventoryManagement InventoryManagement[]

  @@index([addressId])
}

model Address {
  id        Int         @id @default(autoincrement())
  street    String
  city      String
  postcode  String
  household Household[] @relation("HouseholdAddress")
  User      User[]      @relation("UserAddress")
}

model InventoryManagement {
  id        Int         @id @default(autoincrement())
  user      User        @relation(fields: [userId], references: [id])
  household Household   @relation(fields: [familyId], references: [id])
  userId    Int
  familyId  Int
  inventory Inventory[]

  @@index([familyId])
  @@index([userId])
}

model Inventory {
  id                    Int                 @id @default(autoincrement())
  inventoryManagement   InventoryManagement @relation(fields: [inventoryManagementId], references: [id])
  inventoryManagementId Int
  storageFacility       StorageFacility     @relation(fields: [storageFacilityId], references: [id])
  storageFacilityId     Int

  @@index([storageFacilityId])
  @@index([inventoryManagementId])
}

model StorageFacility {
  id       Int    @id @default(autoincrement())
  name     String
  location String

  storedItems StoredItems[]

  inventory Inventory[]
}

model StoredItems {
  id                Int             @id @default(autoincrement())
  name              String
  expiry_date       DateTime?
  purchase_date     DateTime
  purchase_link     String
  image_url         String
  desired_quantity  Int?
  quantity          Int
  storageFacility   StorageFacility @relation(fields: [storageFacilityId], references: [id])
  storageFacilityId Int

  @@index([storageFacilityId])
}

model Supplier {
  id       Int        @id @default(autoincrement())
  name     String
  address  String?
  products Products[]
}

model Products {
  id         Int      @id @default(autoincrement())
  supplier   Supplier @relation(fields: [supplierId], references: [id])
  supplierId Int
  product    Product  @relation(fields: [productId], references: [id])
  productId  Int

  @@index([productId])
  @@index([supplierId])
}

model Product {
  id            Int        @id @default(autoincrement())
  name          String
  purchase_link String?
  image_url     String?
  price         Float?
  products      Products[]
}
